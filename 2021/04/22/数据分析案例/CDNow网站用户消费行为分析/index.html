<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>用户消费有哪些特征？用户质量又如何界定？ | Minz&#39;s DA_Wiki</title>
    
    
        <meta name="keywords" content="DA Project" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="摘要 借由在线音乐零售平台CDNow的部分用户消费数据，分析用户的消费特征、用户的消费质量等～">
<meta property="og:type" content="article">
<meta property="og:title" content="用户消费有哪些特征？用户质量又如何界定？">
<meta property="og:url" content="http://example.com/2021/04/22/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/CDNow%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Minz&#39;s DA_Wiki">
<meta property="og:description" content="摘要 借由在线音乐零售平台CDNow的部分用户消费数据，分析用户的消费特征、用户的消费质量等～">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_15_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_21_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_22_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_25_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_27_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_29_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_33_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_35_1.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_45_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_46_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_53_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_55_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_59_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_62_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_64_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_70_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_75_0.png">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_83_0.png">
<meta property="article:published_time" content="2021-04-22T12:41:02.000Z">
<meta property="article:modified_time" content="2023-02-15T02:19:27.154Z">
<meta property="article:author" content="Minz">
<meta property="article:tag" content="DA Project">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_15_0.png">
    

    
        <link rel="alternate" href="/atom.xml" title="Minz&#39;s DA_Wiki" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/open-sans/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">

    
<script src="/libs/jquery/2.1.3/jquery.min.js"></script>

    
<script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Minz&#39;s DA_Wiki</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            MySQL
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            基础学习
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/07/11/MySQL/mysql%E5%85%B3%E9%94%AE%E5%AD%97%E4%BB%A5%E5%8F%8A%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F/">一条MySQL语句的执行详析</a></li>  <li class="file"><a href="/2021/08/03/MySQL/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%20-%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/">MySQL数据库 - 初步认识</a></li>  <li class="file"><a href="/2021/10/07/MySQL/%E7%95%99%E5%AD%98%E7%8E%87%E6%A6%82%E5%BF%B5&MySQL%E6%A1%88%E4%BE%8B/">MySQL中如何对留存进行分析？</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            练习题集
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/10/06/MySQL/MySQL%E5%9C%BA%E6%99%AF%E6%A8%A1%E6%8B%9F%E5%88%9D%E7%BA%A7%E7%AF%87/">MySQL练习 - 场景模拟初级篇(持续更新)</a></li>  <li class="file"><a href="/2022/10/03/MySQL/MySQL%E7%BB%83%E4%B9%A0%E7%AE%80%E6%98%93%E7%AF%87/">MySQL练习 - 基础篇(持续更新ing)</a></li>  <li class="file"><a href="/2022/10/07/MySQL/hack_no_easy/">HackerRank中SQL练习非简单部分</a></li>  <li class="file"><a href="/2022/11/07/MySQL/hacker/">HackerRank中SQL练习_简单</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Python
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            基础函数
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/08/07/Python/%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0/python%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%20-%20%E5%AD%97%E7%AC%A6%E4%B8%B2/">python数据类型 - 字符串</a></li>  <li class="file"><a href="/2021/08/08/Python/%E5%9F%BA%E7%A1%80%E5%87%BD%E6%95%B0/python%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%20-%20%E5%88%97%E8%A1%A8%E4%B8%8E%E5%AD%97%E5%85%B8/">python数据类型 - 列表与字典</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            库的使用
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/08/09/Python/%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/Matplotlib%E5%85%A5%E9%97%A8%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Matplotlib - 常用图表 & python表格样式</a></li>  <li class="file"><a href="/2021/08/11/Python/%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/Seaborn%E9%A3%8E%E6%A0%BC%E8%AE%BE%E7%BD%AE%E4%B8%8E%E8%B0%83%E8%89%B2%E7%9B%98/">Seaborn - 基础风格展示 & 调色盘</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            分析基础
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            业务指标
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/05/10/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/%E6%95%B0%E6%8D%AE%E6%8C%87%E6%A0%87/">到底什么是数据指标？</a></li>  <li class="file"><a href="/2021/08/29/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/%E6%8C%87%E6%A0%87%E4%B8%8E%E7%BB%B4%E5%BA%A6/">数据分析中的度量和维度</a></li>  <li class="file"><a href="/2021/11/25/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E4%B8%AD%E9%83%A8%E5%88%86%E5%90%8D%E8%AF%8D%E8%A7%A3%E6%9E%90/">什么是趋势分析、特征工程、因子分析 ？</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            分析框架
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/05/15/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/AB%20%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E6%B5%8B%E8%AF%95%E8%AF%B4%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88/">A/B 测试的概念认识</a></li>  <li class="file"><a href="/2021/08/22/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E5%8F%AF%E8%A7%86%E5%8C%96%20-%20%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83%E5%9B%BE%E8%A1%A8part2/">一眼就get到数据分布情况的图表？</a></li>  <li class="file"><a href="/2021/08/25/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E5%90%8C%E6%9C%9F%E7%BE%A4%E5%88%86%E6%9E%90/">同期群分析</a></li>  <li class="file"><a href="/2021/08/25/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E6%A1%86%E6%9E%B6%E4%B8%8B%E7%9A%84%E6%8C%87%E6%A0%87/">框架下的指标</a></li>  <li class="file"><a href="/2021/09/22/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E6%95%B0%E6%8D%AE%E7%89%B9%E5%BE%81%E4%B9%8B%E5%88%86%E5%B8%83%E5%88%86%E6%9E%90/">快速了解数据分布的常用方法</a></li>  <li class="file"><a href="/2021/09/29/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90&%E5%B8%95%E7%B4%AF%E6%89%98%E5%88%86%E6%9E%90/">如何通过对比得出数据差异？以及什么是二八定律</a></li>  <li class="file"><a href="/2021/10/19/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E6%95%B0%E6%8D%AE%E7%89%B9%E5%BE%81%E4%B9%8B%E6%AD%A3%E6%80%81%E6%80%A7%E6%A3%80%E9%AA%8C/">什么是正态分布？如何进行正态性检验？</a></li>  <li class="file"><a href="/2021/10/22/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E7%9B%B8%E5%85%B3%E6%80%A7%E5%88%86%E6%9E%90%E4%B8%8E%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90/">数据的相关性分析 & 统计分析</a></li>  <li class="file"><a href="/2022/08/19/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E5%88%86%E6%9E%90%E6%A1%86%E6%9E%B6/%E5%8F%AF%E8%A7%86%E5%8C%96%20-%20%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83%E5%9B%BE%E8%A1%A8part1/">如何用图表直观显示数据的分布情况？</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            数据清洗
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/08/25/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/">数据分析中的数据清洗流程</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            算法
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/10/29/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/">什么是监督学习和非监督学习？</a></li>  <li class="file"><a href="/2021/11/13/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80/%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95-%E8%92%99%E7%89%B9%E5%8D%A1%E7%BD%97/">随机算法之蒙特卡罗</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            工具搭建
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2023/01/25/%E5%B7%A5%E5%85%B7%E6%90%AD%E5%BB%BA/jupyter-notebook%20%E5%AE%89%E8%A3%85&%E7%BE%8E%E5%8C%96/">jupyter-notebook 安装&美化</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            折腾记录
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            ArchLinux
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2022/08/22/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/ArchLinux/archlinux_common_operation/">archlinux的常用操作命令</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Hexo
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2022/08/22/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/Hexo/hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2&typography%E4%B8%BB%E9%A2%98/">Hexo搭建博客&选择主题</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2021/04/16/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/you-get-%E4%B8%8B%E8%BD%BD%E8%A7%86%E9%A2%91/">如何使用you-get获取视频？</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            数据案例分析
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/2021/01/29/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/%E6%AF%8D%E5%A9%B4%E4%BA%A7%E5%93%81%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">电商项目：母婴用品购买行为分析</a></li>  <li class="file"><a href="/2021/03/01/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/IMDB%E7%94%B5%E5%BD%B1%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">对比分析案例：IMDB电影数据分析及可视化</a></li>  <li class="file"><a href="/2021/03/19/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/%E6%B3%B0%E5%9D%A6%E5%B0%BC%E5%85%8B%E7%94%9F%E5%AD%98%E5%88%86%E6%9E%90/">泰坦尼克号幸存者分析</a></li>  <li class="file"><a href="/2021/04/03/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/%E4%B8%9C%E8%8E%9E%E5%9C%B0%E5%8C%BA%E6%88%BF%E5%B1%8B%E7%A7%9F%E8%B5%81/">某壳网房屋租赁信息抓取与浅析</a></li>  <li class="file"><a href="/2021/04/14/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/%E5%81%A5%E8%BA%AB%E5%B9%B3%E5%8F%B0%E4%BC%9A%E5%91%98%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/">会员用户消费行为浅度挖掘</a></li>  <li class="file active"><a href="/2021/04/22/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/CDNow%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/">用户消费有哪些特征？用户质量又如何界定？</a></li>  <li class="file"><a href="/2021/05/29/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/%E5%A4%A9%E7%8C%AB%E5%8F%8C%E5%8D%81%E4%B8%80%E7%BE%8E%E5%A6%86%E9%94%80%E5%94%AE%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">剖析天猫双十一的美妆产品销售数据</a></li>  <li class="file"><a href="/2021/11/29/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/HR_Analytics/">员工离职原因分析</a></li>  <li class="file"><a href="/2021/12/29/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/Bigmart%20Sale/">大型商场销售额分析</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/2022/01/22/index/">Welcome Minz's DA_Wiki Site</a></li>  </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-数据分析案例/CDNow网站用户消费行为分析" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/">数据案例分析</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/DA-Project/" rel="tag">DA Project</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2021/04/22/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B/CDNow%E7%BD%91%E7%AB%99%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/">
            <time datetime="2021-04-22T12:41:02.000Z" itemprop="datePublished">2021-04-22</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a target="_blank" rel="noopener" href='https://github.com/minzVV/null/raw/null/source/_posts/数据分析案例/CDNow网站用户消费行为分析.md'> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="noopener" href='https://github.com/minzVV/null/edit/null/source/_posts/数据分析案例/CDNow网站用户消费行为分析.md'> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="noopener" href='https://github.com/minzVV/null/commits/null/source/_posts/数据分析案例/CDNow网站用户消费行为分析.md'> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            用户消费有哪些特征？用户质量又如何界定？
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text"> 项目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text"> 数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text"> 数据加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E7%9C%8B"><span class="toc-number">2.2.</span> <span class="toc-text"> 数据查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-%E6%B7%BB%E5%8A%A0%E5%AD%97%E6%AE%B5"><span class="toc-number">2.3.</span> <span class="toc-text"> 数据类型转换 &amp; 添加字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text"> 用户消费分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%80%BB%E4%BD%93%E6%B6%88%E8%B4%B9%E8%B6%8B%E5%8A%BF"><span class="toc-number">3.1.</span> <span class="toc-text"> 用户总体消费趋势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%AA%E4%BD%93%E6%B6%88%E8%B4%B9%E5%88%86%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text"> 用户个体消费分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E9%87%91%E9%A2%9D-%E6%B6%88%E8%B4%B9%E6%AC%A1%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 用户消费金额 &amp; 消费次数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E9%87%91%E9%A2%9D-%E8%B4%AD%E4%B9%B0%E6%95%B0%E9%87%8F%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 用户消费金额 &amp; 购买数量(散点图)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E8%B4%B9%E9%87%91%E9%A2%9D%E5%88%86%E5%B8%83"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 消费金额分布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E6%AC%A1%E6%95%B0"><span class="toc-number">3.2.4.</span> <span class="toc-text"> 用户消费次数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%B4%AF%E8%AE%A1%E6%B6%88%E8%B4%B9%E9%87%91%E9%A2%9D%E5%8D%A0%E6%AF%94"><span class="toc-number">3.2.5.</span> <span class="toc-text"> 用户累计消费金额占比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E5%91%A8%E6%9C%9F"><span class="toc-number">3.3.</span> <span class="toc-text"> 用户消费周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E9%A6%96%E8%B4%AD%E6%97%B6%E9%97%B4"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 用户首购时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E8%B4%AD%E4%B9%B0%E6%97%B6%E9%97%B4"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 用户最后一次购买时间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%88%86%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text"> 用户分层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rfm%E6%A8%A1%E5%9E%8B%E5%88%86%E5%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text"> RFM模型分层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BArfm%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.1.1.</span> <span class="toc-text"> 构建RFM模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E8%B7%83%E5%BA%A6%E5%88%86%E5%B1%82"><span class="toc-number">4.2.</span> <span class="toc-text"> 活跃度分层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E6%B4%BB%E8%B7%83%E5%BA%A6%E5%88%86%E5%B1%82%E7%94%A8%E6%88%B7"><span class="toc-number">4.2.1.</span> <span class="toc-text"> 按照活跃度分层用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%B5%81%E7%94%A8%E6%88%B7%E5%8D%A0%E6%AF%94"><span class="toc-number">4.2.2.</span> <span class="toc-text"> 回流用户占比</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%B4%A8%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text"> 用户质量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%B4%AD%E4%B9%B0%E5%91%A8%E6%9C%9F"><span class="toc-number">5.1.</span> <span class="toc-text"> 用户购买周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">5.2.</span> <span class="toc-text"> 用户生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B6%88%E8%B4%B9%E5%8D%A0%E6%AF%94"><span class="toc-number">5.3.</span> <span class="toc-text"> 用户消费占比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%85%E6%B6%88%E8%B4%B9%E4%B8%80%E6%AC%A1%E7%94%A8%E6%88%B7%E5%8D%A0%E6%AF%94"><span class="toc-number">5.3.1.</span> <span class="toc-text"> 仅消费一次用户占比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E8%B4%B9%E5%A4%9A%E6%AC%A1%E7%94%A8%E6%88%B7%E5%91%A8%E6%9C%9F%E5%88%86%E5%B8%83"><span class="toc-number">5.3.2.</span> <span class="toc-text"> 消费多次用户周期分布</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E8%B4%AD%E7%8E%87-%E5%9B%9E%E8%B4%AD%E7%8E%87%E5%88%86%E6%9E%90"><span class="toc-number">5.4.</span> <span class="toc-text"> 复购率 &amp; 回购率分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E8%B4%AD%E7%8E%87"><span class="toc-number">5.4.1.</span> <span class="toc-text"> 复购率</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E8%B4%AD%E7%8E%87"><span class="toc-number">5.4.2.</span> <span class="toc-text"> 回购率</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%95%99%E5%AD%98%E7%8E%87%E5%88%86%E6%9E%90"><span class="toc-number">5.5.</span> <span class="toc-text"> 留存率分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="toc-number">6.</span> <span class="toc-text"> 写在最后</span></a></li></ol>
                </div>
            
        
        
            <blockquote>
<p>摘要<br />
借由在线音乐零售平台CDNow的部分用户消费数据，分析用户的消费特征、用户的消费质量等～</p>
</blockquote>
<span id="more"></span>
<h2 id="项目描述"><a class="markdownIt-Anchor" href="#项目描述"></a> <strong>项目描述</strong></h2>
<p><strong>项目名称</strong>：CDNow在线音乐零售平台用户消费行为分析</p>
<p><strong>项目背景</strong>：CDNow是一家网络公司，经营着一个在线购物网站，主要销售光盘和音乐相关产品。2000年7月，被Bertelsmann Music Group 以1.17亿美元收购；而后不久，由亚马逊承包经营。本文主要通过分析CDNow网站的用户购买明细数据来分析该网站的用户消费行为，使运营部门在营销时更具有针对性，从而节省成本，提高效率。</p>
<p><strong>字段说明</strong></p>
<blockquote>
<p>用户ID：用户身份唯一标识(数据集中一个用户ID有多条消费记录)</p>
<p>购买日期：即消费日期</p>
<p>订单数：购买数量</p>
<p>订单金额：总消费金额</p>
</blockquote>
<p><strong>项目目的</strong>：</p>
<ul>
<li>用户消费特征
<ul>
<li>用户整体消费分析</li>
<li>用户个人消费分析</li>
<li>用户消费周期</li>
</ul>
</li>
<li>用户分层
<ul>
<li>RFM模型</li>
<li>用户活跃度分层</li>
</ul>
</li>
<li>用户质量分析
<ul>
<li>消费频次</li>
<li>复购率</li>
<li>回购率</li>
<li>留存率</li>
</ul>
</li>
</ul>
<h2 id="数据处理"><a class="markdownIt-Anchor" href="#数据处理"></a> <strong>数据处理</strong></h2>
<h3 id="数据加载"><a class="markdownIt-Anchor" href="#数据加载"></a> <strong>数据加载</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> ss</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&quot;/home/min/data&quot;</span>)</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置列名</span></span><br><span class="line"></span><br><span class="line">colums = [<span class="string">&#x27;用户ID&#x27;</span>,<span class="string">&#x27;购买日期&#x27;</span>,<span class="string">&#x27;订单数&#x27;</span>,<span class="string">&#x27;订单金额&#x27;</span>]</span><br><span class="line">data = pd.read_csv(<span class="string">&quot;CDNOW.txt&quot;</span>,names = colums,sep=<span class="string">&quot;\s+&quot;</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>购买日期</th>
      <th>订单数</th>
      <th>订单金额</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>19970101</td>
      <td>1</td>
      <td>11.77</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>19970112</td>
      <td>1</td>
      <td>12.00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>19970112</td>
      <td>5</td>
      <td>77.00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>19970102</td>
      <td>2</td>
      <td>20.76</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>19970330</td>
      <td>2</td>
      <td>20.76</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<h3 id="数据查看"><a class="markdownIt-Anchor" href="#数据查看"></a> <strong>数据查看</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>购买日期</th>
      <th>订单数</th>
      <th>订单金额</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>69659.000000</td>
      <td>6.965900e+04</td>
      <td>69659.000000</td>
      <td>69659.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>11470.854592</td>
      <td>1.997228e+07</td>
      <td>2.410040</td>
      <td>35.893648</td>
    </tr>
    <tr>
      <td>std</td>
      <td>6819.904848</td>
      <td>3.837735e+03</td>
      <td>2.333924</td>
      <td>36.281942</td>
    </tr>
    <tr>
      <td>min</td>
      <td>1.000000</td>
      <td>1.997010e+07</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>5506.000000</td>
      <td>1.997022e+07</td>
      <td>1.000000</td>
      <td>14.490000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>11410.000000</td>
      <td>1.997042e+07</td>
      <td>2.000000</td>
      <td>25.980000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>17273.000000</td>
      <td>1.997111e+07</td>
      <td>3.000000</td>
      <td>43.700000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>23570.000000</td>
      <td>1.998063e+07</td>
      <td>99.000000</td>
      <td>1286.010000</td>
    </tr>
  </tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.info()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 69659 entries, 0 to 69658
Data columns (total 4 columns):
用户ID    69659 non-null int64
购买日期    69659 non-null int64
订单数     69659 non-null int64
订单金额    69659 non-null float64
dtypes: float64(1), int64(3)
memory usage: 2.1 MB
</code></pre>
</br>
<h3 id="数据类型转换-添加字段"><a class="markdownIt-Anchor" href="#数据类型转换-添加字段"></a> <strong>数据类型转换 &amp; 添加字段</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换日期类型</span></span><br><span class="line"></span><br><span class="line">data[<span class="string">&#x27;购买日期&#x27;</span>] = pd.to_datetime(data[<span class="string">&#x27;购买日期&#x27;</span>],<span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d&#x27;</span>)</span><br><span class="line">data[<span class="string">&#x27;月份&#x27;</span>] = data[<span class="string">&#x27;购买日期&#x27;</span>].values.astype(<span class="string">&#x27;datetime64[M]&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.info()</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 69659 entries, 0 to 69658
Data columns (total 5 columns):
用户ID    69659 non-null int64
购买日期    69659 non-null datetime64[ns]
订单数     69659 non-null int64
订单金额    69659 non-null float64
月份      69659 non-null datetime64[ns]
dtypes: datetime64[ns](2), float64(1), int64(2)
memory usage: 2.7 MB
</code></pre>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>购买日期</th>
      <th>订单数</th>
      <th>订单金额</th>
      <th>月份</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>1997-01-01</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1997-01-12</td>
      <td>1</td>
      <td>12.00</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>1997-01-12</td>
      <td>5</td>
      <td>77.00</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>1997-01-02</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>1997-03-30</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-03-01</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查空值</span></span><br><span class="line"></span><br><span class="line">data.apply(<span class="keyword">lambda</span> x:<span class="built_in">sum</span>(x.isnull()))</span><br></pre></td></tr></table></figure>
<pre><code>用户ID    0
购买日期    0
订单数     0
订单金额    0
月份      0
dtype: int64
</code></pre>
</br>
<h2 id="用户消费分析"><a class="markdownIt-Anchor" href="#用户消费分析"></a> <strong>用户消费分析</strong></h2>
<h3 id="用户总体消费趋势"><a class="markdownIt-Anchor" href="#用户总体消费趋势"></a> <strong>用户总体消费趋势</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照月份初步查看用户总体消费趋势分析</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图风格选择</span></span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;ggplot&#x27;</span>)</span><br><span class="line">plt.figure(figsize = (<span class="number">20</span>,<span class="number">12</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月的中销售额</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">221</span>)</span><br><span class="line">data.groupby(<span class="string">&#x27;月份&#x27;</span>)[<span class="string">&#x27;订单金额&#x27;</span>].<span class="built_in">sum</span>().plot(fontsize = <span class="number">24</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;总销售额&#x27;</span>,fontsize = <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月的消费次数</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">222</span>)</span><br><span class="line">data.groupby(<span class="string">&#x27;月份&#x27;</span>)[<span class="string">&#x27;购买日期&#x27;</span>].count().plot(fontsize = <span class="number">24</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;消费次数&#x27;</span>,fontsize = <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月的销量</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">223</span>)</span><br><span class="line">data.groupby(<span class="string">&#x27;月份&#x27;</span>)[<span class="string">&#x27;订单数&#x27;</span>].<span class="built_in">sum</span>().plot(fontsize = <span class="number">24</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;总销量&#x27;</span>,fontsize = <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每月的消费人数</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">224</span>)</span><br><span class="line">data.groupby(<span class="string">&#x27;月份&#x27;</span>)[<span class="string">&#x27;用户ID&#x27;</span>].apply(<span class="keyword">lambda</span> x:<span class="built_in">len</span>(x.unique())).plot(fontsize = <span class="number">24</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;消费人数&#x27;</span>,fontsize = <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_15_0.png" alt="" /></p>
<p><strong>图表解析</strong>：四个折线图趋势基本一致，呈现为前3个月销量极高，销售额暴涨，往后骤然下降，最后趋于平稳。</p>
<ul>
<li>
<p>消费金额在前三个月达到最高峰，后期消费金额较为平稳，呈小幅度下降趋势</p>
</li>
<li>
<p>前三个月消费次数在10000左右，往后月份消费次数基本维持在2500</p>
</li>
<li>
<p>产品购买量趋势呈现为早起购买量多 后期小幅度下降趋势</p>
</li>
<li>
<p>每月消费人数小于每月的消费次数（订单数），但是区别不大，前三个月每月的消费人数在8000-10000之间，后续月份平均2000左右，一样是前期消费人数多，后期平稳下降趋势</p>
<p>出现这种状况，假设问题是出现在用户身上，早期时间段的用户有异常值，或者由于各类促销营销，由于只有消费数据，无法进一步进行判断</p>
</li>
</ul>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据透视查看 -- 按照月份查看用户购买金额、订单数、用户人数</span></span><br><span class="line"></span><br><span class="line">data.pivot_table(index=<span class="string">&#x27;月份&#x27;</span>,</span><br><span class="line">                values=[<span class="string">&#x27;订单数&#x27;</span>,<span class="string">&#x27;订单金额&#x27;</span>,<span class="string">&#x27;用户ID&#x27;</span>],</span><br><span class="line">                aggfunc=&#123;<span class="string">&#x27;订单数&#x27;</span>:<span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;订单金额&#x27;</span>:<span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;用户ID&#x27;</span>:<span class="string">&#x27;count&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>订单数</th>
      <th>订单金额</th>
    </tr>
    <tr>
      <th>月份</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1997-01-01</td>
      <td>8928</td>
      <td>19416</td>
      <td>299060.17</td>
    </tr>
    <tr>
      <td>1997-02-01</td>
      <td>11272</td>
      <td>24921</td>
      <td>379590.03</td>
    </tr>
    <tr>
      <td>1997-03-01</td>
      <td>11598</td>
      <td>26159</td>
      <td>393155.27</td>
    </tr>
    <tr>
      <td>1997-04-01</td>
      <td>3781</td>
      <td>9729</td>
      <td>142824.49</td>
    </tr>
    <tr>
      <td>1997-05-01</td>
      <td>2895</td>
      <td>7275</td>
      <td>107933.30</td>
    </tr>
    <tr>
      <td>1997-06-01</td>
      <td>3054</td>
      <td>7301</td>
      <td>108395.87</td>
    </tr>
    <tr>
      <td>1997-07-01</td>
      <td>2942</td>
      <td>8131</td>
      <td>122078.88</td>
    </tr>
    <tr>
      <td>1997-08-01</td>
      <td>2320</td>
      <td>5851</td>
      <td>88367.69</td>
    </tr>
    <tr>
      <td>1997-09-01</td>
      <td>2296</td>
      <td>5729</td>
      <td>81948.80</td>
    </tr>
    <tr>
      <td>1997-10-01</td>
      <td>2562</td>
      <td>6203</td>
      <td>89780.77</td>
    </tr>
    <tr>
      <td>1997-11-01</td>
      <td>2750</td>
      <td>7812</td>
      <td>115448.64</td>
    </tr>
    <tr>
      <td>1997-12-01</td>
      <td>2504</td>
      <td>6418</td>
      <td>95577.35</td>
    </tr>
    <tr>
      <td>1998-01-01</td>
      <td>2032</td>
      <td>5278</td>
      <td>76756.78</td>
    </tr>
    <tr>
      <td>1998-02-01</td>
      <td>2026</td>
      <td>5340</td>
      <td>77096.96</td>
    </tr>
    <tr>
      <td>1998-03-01</td>
      <td>2793</td>
      <td>7431</td>
      <td>108970.15</td>
    </tr>
    <tr>
      <td>1998-04-01</td>
      <td>1878</td>
      <td>4697</td>
      <td>66231.52</td>
    </tr>
    <tr>
      <td>1998-05-01</td>
      <td>1985</td>
      <td>4903</td>
      <td>70989.66</td>
    </tr>
    <tr>
      <td>1998-06-01</td>
      <td>2043</td>
      <td>5287</td>
      <td>76109.30</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<h3 id="用户个体消费分析"><a class="markdownIt-Anchor" href="#用户个体消费分析"></a> <strong>用户个体消费分析</strong></h3>
<h4 id="用户消费金额-消费次数"><a class="markdownIt-Anchor" href="#用户消费金额-消费次数"></a> <strong>用户消费金额 &amp; 消费次数</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户个体消费</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据用户ID进行分组</span></span><br><span class="line"><span class="comment"># 1、用户消费金额 &amp; 消费次数</span></span><br><span class="line"></span><br><span class="line">group_user = data.groupby(<span class="string">&#x27;用户ID&#x27;</span>).<span class="built_in">sum</span>()</span><br><span class="line">group_user.describe()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>订单数</th>
      <th>订单金额</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>23570.000000</td>
      <td>23570.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>7.122656</td>
      <td>106.080426</td>
    </tr>
    <tr>
      <td>std</td>
      <td>16.983531</td>
      <td>240.925195</td>
    </tr>
    <tr>
      <td>min</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>1.000000</td>
      <td>19.970000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>3.000000</td>
      <td>43.395000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>7.000000</td>
      <td>106.475000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>1033.000000</td>
      <td>13990.930000</td>
    </tr>
  </tbody>
</table>
</div>
<p><strong>图表解析</strong>：</p>
<ul>
<li>用户平均购买7张CD，而标准差为17，说明波动较大；中位值只有3，更是说明了存在小部分用户购买了大数量的CD</li>
<li>用户平均消费金额106，中位值是43，也说明了存在极值干扰</li>
</ul>
</br>
<h4 id="用户消费金额-购买数量散点图"><a class="markdownIt-Anchor" href="#用户消费金额-购买数量散点图"></a> <strong>用户消费金额 &amp; 购买数量(散点图)</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2、散点图 -- 设置去除某些极值</span></span><br><span class="line"></span><br><span class="line">group_user.query(<span class="string">&#x27;订单金额 &lt; 4000&#x27;</span>).plot.scatter(x = <span class="string">&#x27;订单金额&#x27;</span>,y = <span class="string">&#x27;订单数&#x27;</span>,figsize = (<span class="number">20</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_21_1.png" alt="" /></p>
<p><strong>图表解析</strong>：由于数据源是CD网站的销售数据，商品种类单一，金额和商品量呈线性，并不存在大量离群点。</p>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每笔订单消费金额</span></span><br><span class="line"></span><br><span class="line">data.plot.scatter(x = <span class="string">&#x27;订单金额&#x27;</span>,y = <span class="string">&#x27;订单数&#x27;</span>,figsize = (<span class="number">20</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_22_1.png" alt="" /></p>
<p><strong>图表解析</strong>：从订单角度分析，订单消费金额多数在0～400，而每笔订单购买数量大多在0～40，而且订单购买数量极值极少，基本与上方用户消费角度分析趋势一致。</p>
</br>
<h4 id="消费金额分布"><a class="markdownIt-Anchor" href="#消费金额分布"></a> <strong>消费金额分布</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3、用户消费金额的分布图</span></span><br><span class="line"></span><br><span class="line">group_user[<span class="string">&#x27;订单金额&#x27;</span>].plot.hist(bins = <span class="number">20</span>,figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_25_1.png" alt="" /></p>
<p><strong>图表解析</strong>：用户大部分消费能力不高，基本上绝大部分用户处于很低的消费档次，图中基本看不到高消费用户。</p>
</br>
<h4 id="用户消费次数"><a class="markdownIt-Anchor" href="#用户消费次数"></a> <strong>用户消费次数</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4、用户消费次数分布  --  去除某些极值</span></span><br><span class="line"></span><br><span class="line">group_user.query(<span class="string">&#x27;订单数 &lt; 92&#x27;</span>)[<span class="string">&#x27;订单数&#x27;</span>].hist(bins = <span class="number">40</span>,figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_27_1.png" alt="" /></p>
<p><strong>图表解析</strong>：排除部分极值干扰，可看出大部分用户购买CD的数量都在3张以内，购买大数量的用户属极少数。</p>
</br>
<h4 id="用户累计消费金额占比"><a class="markdownIt-Anchor" href="#用户累计消费金额占比"></a> <strong>用户累计消费金额占比</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户累计消费金额占比</span></span><br><span class="line"></span><br><span class="line">user_cumsum = group_user.sort_values(<span class="string">&#x27;订单金额&#x27;</span>).apply(<span class="keyword">lambda</span> x:x.cumsum() / x.<span class="built_in">sum</span>())</span><br><span class="line">user_cumsum.reset_index()[<span class="string">&#x27;订单金额&#x27;</span>].plot(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_29_1.png" alt="" /></p>
<p><strong>图表解析</strong>：50%的用户仅贡献了15%的消费额，而排名前5000的用户就贡献了60%的消费金额。</p>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># user_cumsum.head(10)</span></span><br><span class="line"><span class="comment"># user_cumsum.tail(10)</span></span><br></pre></td></tr></table></figure>
</br>
<h3 id="用户消费周期"><a class="markdownIt-Anchor" href="#用户消费周期"></a> <strong>用户消费周期</strong></h3>
<h4 id="用户首购时间"><a class="markdownIt-Anchor" href="#用户首购时间"></a> <strong>用户首购时间</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、第一次购买时间</span></span><br><span class="line"></span><br><span class="line">orderdt_min = data.groupby(<span class="string">&#x27;用户ID&#x27;</span>).<span class="built_in">min</span>()[<span class="string">&#x27;购买日期&#x27;</span>]</span><br><span class="line">orderdt_min.value_counts().plot(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_33_1.png" alt="" /></p>
<p>**图表解析：**用户第一次购买基本集中在前三个月，而在2月份中下旬有一次较大的波动</p>
</br>
<h4 id="用户最后一次购买时间"><a class="markdownIt-Anchor" href="#用户最后一次购买时间"></a> <strong>用户最后一次购买时间</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最后一次购买时间</span></span><br><span class="line"></span><br><span class="line">orderdt_max = data.groupby(<span class="string">&#x27;用户ID&#x27;</span>).<span class="built_in">max</span>()[<span class="string">&#x27;购买日期&#x27;</span>]</span><br><span class="line">orderdt_max.value_counts().plot(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_35_1.png" alt="" /></p>
<p><strong>图表解析：</strong></p>
<ul>
<li>用户最后一次购买的分布比第一次购买分布要广</li>
<li>大部分最后一次购买在前三个月，说明很多用户购买一次之后就不再消费</li>
<li>往后月份，最后一次购买数呈小幅度递增，有上升趋势</li>
</ul>
</br>
<h2 id="用户分层"><a class="markdownIt-Anchor" href="#用户分层"></a> <strong>用户分层</strong></h2>
<h3 id="rfm模型分层"><a class="markdownIt-Anchor" href="#rfm模型分层"></a> <strong>RFM模型分层</strong></h3>
<h4 id="构建rfm模型"><a class="markdownIt-Anchor" href="#构建rfm模型"></a> <strong>构建RFM模型</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rfm = data.pivot_table(index = <span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">                      values=[<span class="string">&#x27;订单数&#x27;</span>,<span class="string">&#x27;订单金额&#x27;</span>,<span class="string">&#x27;购买日期&#x27;</span>],</span><br><span class="line">                      aggfunc=&#123;<span class="string">&#x27;购买日期&#x27;</span>:<span class="string">&#x27;max&#x27;</span>,</span><br><span class="line">                              <span class="string">&#x27;订单金额&#x27;</span>:<span class="string">&#x27;sum&#x27;</span>,</span><br><span class="line">                              <span class="string">&#x27;订单数&#x27;</span>:<span class="string">&#x27;sum&#x27;</span>&#125;)</span><br><span class="line">rfm.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>订单数</th>
      <th>订单金额</th>
      <th>购买日期</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6</td>
      <td>89.00</td>
      <td>1997-01-12</td>
    </tr>
    <tr>
      <td>3</td>
      <td>16</td>
      <td>156.46</td>
      <td>1998-05-28</td>
    </tr>
    <tr>
      <td>4</td>
      <td>7</td>
      <td>100.50</td>
      <td>1997-12-12</td>
    </tr>
    <tr>
      <td>5</td>
      <td>29</td>
      <td>385.61</td>
      <td>1998-01-03</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-(rfm[<span class="string">&#x27;购买日期&#x27;</span>] - rfm[<span class="string">&#x27;购买日期&#x27;</span>].<span class="built_in">max</span>()).head()</span><br></pre></td></tr></table></figure>
<pre><code>用户ID
1   545 days
2   534 days
3    33 days
4   200 days
5   178 days
Name: 购买日期, dtype: timedelta64[ns]
</code></pre>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重命名 &amp; 去除单位</span></span><br><span class="line"></span><br><span class="line">rfm[<span class="string">&#x27;R&#x27;</span>] = -(rfm[<span class="string">&#x27;购买日期&#x27;</span>] - rfm[<span class="string">&#x27;购买日期&#x27;</span>].<span class="built_in">max</span>()) / np.timedelta64(<span class="number">1</span>,<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">rfm.rename(columns=&#123;<span class="string">&#x27;订单数&#x27;</span>:<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;订单金额&#x27;</span>:<span class="string">&#x27;M&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line">rfm.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>F</th>
      <th>M</th>
      <th>购买日期</th>
      <th>R</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
      <td>545.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6</td>
      <td>89.00</td>
      <td>1997-01-12</td>
      <td>534.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>16</td>
      <td>156.46</td>
      <td>1998-05-28</td>
      <td>33.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>7</td>
      <td>100.50</td>
      <td>1997-12-12</td>
      <td>200.0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>29</td>
      <td>385.61</td>
      <td>1998-01-03</td>
      <td>178.0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rfm[[<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;M&#x27;</span>]].apply(<span class="keyword">lambda</span> x:x-x.mean()).head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>177.778362</td>
      <td>-6.122656</td>
      <td>-94.310426</td>
    </tr>
    <tr>
      <td>2</td>
      <td>166.778362</td>
      <td>-1.122656</td>
      <td>-17.080426</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-334.221638</td>
      <td>8.877344</td>
      <td>50.379574</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-167.221638</td>
      <td>-0.122656</td>
      <td>-5.580426</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-189.221638</td>
      <td>21.877344</td>
      <td>279.529574</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rfm_func</span>(<span class="params">x</span>):</span><br><span class="line">    level = x.apply(<span class="keyword">lambda</span> x:<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> x&gt;=<span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    label = level.R + level.F + level.M</span><br><span class="line">    d = &#123;</span><br><span class="line">        <span class="string">&#x27;111&#x27;</span>:<span class="string">&#x27;重要价值客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;011&#x27;</span>:<span class="string">&#x27;重要保持客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;101&#x27;</span>:<span class="string">&#x27;重要挽留客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;001&#x27;</span>:<span class="string">&#x27;重要发展客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;110&#x27;</span>:<span class="string">&#x27;一般价值客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;010&#x27;</span>:<span class="string">&#x27;一般保持客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;100&#x27;</span>:<span class="string">&#x27;一般挽留客户&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;000&#x27;</span>:<span class="string">&#x27;一般发展客户&#x27;</span>,        </span><br><span class="line">    &#125;</span><br><span class="line">    result = d[label]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">rfm[<span class="string">&#x27;label&#x27;</span>] = rfm[[<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;M&#x27;</span>]].apply(<span class="keyword">lambda</span> x:x-x.mean()).apply(rfm_func,axis = <span class="number">1</span>)</span><br><span class="line">rfm.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>F</th>
      <th>M</th>
      <th>购买日期</th>
      <th>R</th>
      <th>label</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
      <td>545.0</td>
      <td>一般挽留客户</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6</td>
      <td>89.00</td>
      <td>1997-01-12</td>
      <td>534.0</td>
      <td>一般挽留客户</td>
    </tr>
    <tr>
      <td>3</td>
      <td>16</td>
      <td>156.46</td>
      <td>1998-05-28</td>
      <td>33.0</td>
      <td>重要保持客户</td>
    </tr>
    <tr>
      <td>4</td>
      <td>7</td>
      <td>100.50</td>
      <td>1997-12-12</td>
      <td>200.0</td>
      <td>一般发展客户</td>
    </tr>
    <tr>
      <td>5</td>
      <td>29</td>
      <td>385.61</td>
      <td>1998-01-03</td>
      <td>178.0</td>
      <td>重要保持客户</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rfm.groupby(<span class="string">&#x27;label&#x27;</span>).<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>F</th>
      <th>M</th>
      <th>R</th>
    </tr>
    <tr>
      <th>label</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>一般价值客户</td>
      <td>650</td>
      <td>7181.28</td>
      <td>36295.0</td>
    </tr>
    <tr>
      <td>一般保持客户</td>
      <td>1712</td>
      <td>19937.45</td>
      <td>29448.0</td>
    </tr>
    <tr>
      <td>一般发展客户</td>
      <td>13977</td>
      <td>196971.23</td>
      <td>591108.0</td>
    </tr>
    <tr>
      <td>一般挽留客户</td>
      <td>29346</td>
      <td>438291.81</td>
      <td>6951815.0</td>
    </tr>
    <tr>
      <td>重要价值客户</td>
      <td>11121</td>
      <td>167080.83</td>
      <td>358363.0</td>
    </tr>
    <tr>
      <td>重要保持客户</td>
      <td>107789</td>
      <td>1592039.62</td>
      <td>517267.0</td>
    </tr>
    <tr>
      <td>重要发展客户</td>
      <td>2023</td>
      <td>45785.01</td>
      <td>56636.0</td>
    </tr>
    <tr>
      <td>重要挽留客户</td>
      <td>1263</td>
      <td>33028.40</td>
      <td>114482.0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rfm.groupby(<span class="string">&#x27;label&#x27;</span>).count()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>F</th>
      <th>M</th>
      <th>购买日期</th>
      <th>R</th>
    </tr>
    <tr>
      <th>label</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>一般价值客户</td>
      <td>77</td>
      <td>77</td>
      <td>77</td>
      <td>77</td>
    </tr>
    <tr>
      <td>一般保持客户</td>
      <td>206</td>
      <td>206</td>
      <td>206</td>
      <td>206</td>
    </tr>
    <tr>
      <td>一般发展客户</td>
      <td>3300</td>
      <td>3300</td>
      <td>3300</td>
      <td>3300</td>
    </tr>
    <tr>
      <td>一般挽留客户</td>
      <td>14074</td>
      <td>14074</td>
      <td>14074</td>
      <td>14074</td>
    </tr>
    <tr>
      <td>重要价值客户</td>
      <td>787</td>
      <td>787</td>
      <td>787</td>
      <td>787</td>
    </tr>
    <tr>
      <td>重要保持客户</td>
      <td>4554</td>
      <td>4554</td>
      <td>4554</td>
      <td>4554</td>
    </tr>
    <tr>
      <td>重要发展客户</td>
      <td>331</td>
      <td>331</td>
      <td>331</td>
      <td>331</td>
    </tr>
    <tr>
      <td>重要挽留客户</td>
      <td>241</td>
      <td>241</td>
      <td>241</td>
      <td>241</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 各类型用户占比</span></span><br><span class="line"></span><br><span class="line">user_t = rfm.groupby(<span class="string">&#x27;label&#x27;</span>).count()</span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">labels = [<span class="string">&#x27;一般价值客户&#x27;</span>,<span class="string">&#x27;一般保持客户&#x27;</span>,<span class="string">&#x27;一般发展客户&#x27;</span>,<span class="string">&#x27;一般挽留客户&#x27;</span>,<span class="string">&#x27;重要价值客户&#x27;</span>,<span class="string">&#x27;重要保持客户&#x27;</span>,<span class="string">&#x27;重要发展客户&#x27;</span>,<span class="string">&#x27;重要挽留客户&#x27;</span>]</span><br><span class="line">plt.pie(user_t[<span class="string">&#x27;M&#x27;</span>],</span><br><span class="line">       autopct=<span class="string">&#x27;%3.1f%%&#x27;</span>,</span><br><span class="line">       labels=labels,</span><br><span class="line">       pctdistance=<span class="number">0.9</span>,</span><br><span class="line">       labeldistance=<span class="number">1.2</span>,</span><br><span class="line">       radius = <span class="number">3</span>,</span><br><span class="line">       startangle=<span class="number">15</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_45_0.png" alt="" /></p>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line"><span class="keyword">for</span> label,grouped <span class="keyword">in</span> rfm.groupby(<span class="string">&#x27;label&#x27;</span>):</span><br><span class="line">    x = grouped[<span class="string">&#x27;F&#x27;</span>]</span><br><span class="line">    y = grouped[<span class="string">&#x27;R&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    plt.scatter(x,y,label = label)</span><br><span class="line">plt.legend(loc = <span class="string">&#x27;best&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Frequency&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Recency&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_46_0.png" alt="" /></p>
<p><strong>图表解析</strong>：可以看出，大部分用户为重要保持客户，原因可能是存在极值，也说明了RFM模型的划分应该依照业务的实际情况来进行划分层级。</p>
</br>
<h3 id="活跃度分层"><a class="markdownIt-Anchor" href="#活跃度分层"></a> <strong>活跃度分层</strong></h3>
<h4 id="按照活跃度分层用户"><a class="markdownIt-Anchor" href="#按照活跃度分层用户"></a> <strong>按照活跃度分层用户</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过每月是否消费来划分用户</span></span><br><span class="line"></span><br><span class="line">pivoted_counts = data.pivot_table(index=<span class="string">&#x27;用户ID&#x27;</span>,</span><br><span class="line">                                 columns=<span class="string">&#x27;月份&#x27;</span>,</span><br><span class="line">                                 values=<span class="string">&#x27;购买日期&#x27;</span>,</span><br><span class="line">                                 aggfunc=<span class="string">&#x27;count&#x27;</span>).fillna(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">pivoted_counts.columns = data[<span class="string">&#x27;月份&#x27;</span>].sort_values().astype(<span class="string">&#x27;str&#x27;</span>).unique()</span><br><span class="line">pivoted_counts.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_purchase = pivoted_counts.applymap(<span class="keyword">lambda</span> x:<span class="number">1</span> <span class="keyword">if</span> x&gt;<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">data_purchase.tail()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>23566</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>23567</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>23568</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>23569</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>23570</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">active_status</span>(<span class="params">data</span>):</span><br><span class="line">    status = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        <span class="keyword">if</span> data[i] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(status) &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> status[i-<span class="number">1</span>] == <span class="string">&#x27;unreg&#x27;</span>:</span><br><span class="line">                    status.append(<span class="string">&#x27;unreg&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    status.append(<span class="string">&#x27;unactive&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                status.append(<span class="string">&#x27;unreg&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(status) == <span class="number">0</span>:</span><br><span class="line">                status.append(<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> status[i-<span class="number">1</span>] == <span class="string">&#x27;unactive&#x27;</span>:</span><br><span class="line">                    status.append(<span class="string">&#x27;return&#x27;</span>)</span><br><span class="line">                <span class="keyword">elif</span> status[i-<span class="number">1</span>] == <span class="string">&#x27;unreg&#x27;</span>:</span><br><span class="line">                    status.append(<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    status.append(<span class="string">&#x27;active&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> pd.Series(status,data_purchase.columns)</span><br></pre></td></tr></table></figure>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">purchase_states = data_purchase.apply(active_status,axis = <span class="number">1</span>)</span><br><span class="line">purchase_states.tail()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>23566</td>
      <td>unreg</td>
      <td>unreg</td>
      <td>new</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
    </tr>
    <tr>
      <td>23567</td>
      <td>unreg</td>
      <td>unreg</td>
      <td>new</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
    </tr>
    <tr>
      <td>23568</td>
      <td>unreg</td>
      <td>unreg</td>
      <td>new</td>
      <td>active</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
    </tr>
    <tr>
      <td>23569</td>
      <td>unreg</td>
      <td>unreg</td>
      <td>new</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
    </tr>
    <tr>
      <td>23570</td>
      <td>unreg</td>
      <td>unreg</td>
      <td>new</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
      <td>unactive</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 去除未注册的用户 -- 设置为空值</span></span><br><span class="line"></span><br><span class="line">purchase_states_m = purchase_states.replace(<span class="string">&#x27;unreg&#x27;</span>,np.NaN).apply(<span class="keyword">lambda</span> x:pd.value_counts(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转置</span></span><br><span class="line"></span><br><span class="line">purchase_states_m = purchase_states_m.fillna(<span class="number">0</span>).T</span><br><span class="line">purchase_states_m</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>active</th>
      <th>new</th>
      <th>return</th>
      <th>unactive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1997-01-01</td>
      <td>0.0</td>
      <td>7846.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1997-02-01</td>
      <td>1157.0</td>
      <td>8476.0</td>
      <td>0.0</td>
      <td>6689.0</td>
    </tr>
    <tr>
      <td>1997-03-01</td>
      <td>1681.0</td>
      <td>7248.0</td>
      <td>595.0</td>
      <td>14046.0</td>
    </tr>
    <tr>
      <td>1997-04-01</td>
      <td>1773.0</td>
      <td>0.0</td>
      <td>1049.0</td>
      <td>20748.0</td>
    </tr>
    <tr>
      <td>1997-05-01</td>
      <td>852.0</td>
      <td>0.0</td>
      <td>1362.0</td>
      <td>21356.0</td>
    </tr>
    <tr>
      <td>1997-06-01</td>
      <td>747.0</td>
      <td>0.0</td>
      <td>1592.0</td>
      <td>21231.0</td>
    </tr>
    <tr>
      <td>1997-07-01</td>
      <td>746.0</td>
      <td>0.0</td>
      <td>1434.0</td>
      <td>21390.0</td>
    </tr>
    <tr>
      <td>1997-08-01</td>
      <td>604.0</td>
      <td>0.0</td>
      <td>1168.0</td>
      <td>21798.0</td>
    </tr>
    <tr>
      <td>1997-09-01</td>
      <td>528.0</td>
      <td>0.0</td>
      <td>1211.0</td>
      <td>21831.0</td>
    </tr>
    <tr>
      <td>1997-10-01</td>
      <td>532.0</td>
      <td>0.0</td>
      <td>1307.0</td>
      <td>21731.0</td>
    </tr>
    <tr>
      <td>1997-11-01</td>
      <td>624.0</td>
      <td>0.0</td>
      <td>1404.0</td>
      <td>21542.0</td>
    </tr>
    <tr>
      <td>1997-12-01</td>
      <td>632.0</td>
      <td>0.0</td>
      <td>1232.0</td>
      <td>21706.0</td>
    </tr>
    <tr>
      <td>1998-01-01</td>
      <td>512.0</td>
      <td>0.0</td>
      <td>1025.0</td>
      <td>22033.0</td>
    </tr>
    <tr>
      <td>1998-02-01</td>
      <td>472.0</td>
      <td>0.0</td>
      <td>1079.0</td>
      <td>22019.0</td>
    </tr>
    <tr>
      <td>1998-03-01</td>
      <td>571.0</td>
      <td>0.0</td>
      <td>1489.0</td>
      <td>21510.0</td>
    </tr>
    <tr>
      <td>1998-04-01</td>
      <td>518.0</td>
      <td>0.0</td>
      <td>919.0</td>
      <td>22133.0</td>
    </tr>
    <tr>
      <td>1998-05-01</td>
      <td>459.0</td>
      <td>0.0</td>
      <td>1029.0</td>
      <td>22082.0</td>
    </tr>
    <tr>
      <td>1998-06-01</td>
      <td>446.0</td>
      <td>0.0</td>
      <td>1060.0</td>
      <td>22064.0</td>
    </tr>
  </tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">purchase_states_m.plot.area(figsize = (<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_53_0.png" alt="" /></p>
<p><strong>图表解析</strong>：</p>
<ul>
<li>蓝色和灰色区域占了绝大部分面积，推断为某段时间消费过的用户的后续行为</li>
<li>红色部分代表的活跃用户较为稳定，属于核心用户</li>
<li>紫色部分代表的回流用户也表现的较为稳定</li>
</ul>
</br>
<h4 id="回流用户占比"><a class="markdownIt-Anchor" href="#回流用户占比"></a> <strong>回流用户占比</strong></h4>
<blockquote>
<p>回流用户比：某个时间段内回流用户在总用户中的占比</p>
<p>回流用户率：相比上月有多少不活跃用户在本月进行了消费</p>
<p>活跃用户比：某个时间段内活跃用户在总用户中的占比</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">6</span>))</span><br><span class="line">rate = purchase_states_m.apply(<span class="keyword">lambda</span> x: x/x.<span class="built_in">sum</span>())</span><br><span class="line">plt.plot(rate[<span class="string">&#x27;return&#x27;</span>],label = <span class="string">&#x27;回流用户&#x27;</span>)</span><br><span class="line">plt.plot(rate[<span class="string">&#x27;active&#x27;</span>],label = <span class="string">&#x27;活跃用户&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_55_0.png" alt="" /></p>
<p><strong>图表解析</strong>：</p>
<ul>
<li>用户每月回流用户比在5%~8%之间，且有小幅度下降趋势，说明客户有流失可能</li>
<li>数据源中不活跃用户量基本保持不变，所以回流率近似于回流比</li>
<li>活跃用户的占比基本稳定在3%~5%之间，下降趋势更明显</li>
<li>结合活跃用户和回流用户，在后期的消费用户中，近60%是回流用户，40%为活跃用户，说明整体用户质量相对不错。</li>
</ul>
</br>
<h2 id="用户质量分析"><a class="markdownIt-Anchor" href="#用户质量分析"></a> <strong>用户质量分析</strong></h2>
<h3 id="用户购买周期"><a class="markdownIt-Anchor" href="#用户购买周期"></a> <strong>用户购买周期</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">order_diff = data.groupby(<span class="string">&#x27;用户ID&#x27;</span>).apply(<span class="keyword">lambda</span> x: x[<span class="string">&#x27;购买日期&#x27;</span>] - x[<span class="string">&#x27;购买日期&#x27;</span>].shift())</span><br><span class="line">order_diff.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<pre><code>用户ID   
1     0        NaT
2     1        NaT
      2     0 days
3     3        NaT
      4    87 days
      5     3 days
      6   227 days
      7    10 days
      8   184 days
4     9        NaT
Name: 购买日期, dtype: timedelta64[ns]
</code></pre>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order_diff.describe()</span><br></pre></td></tr></table></figure>
<pre><code>count                      46089
mean     68 days 23:22:13.567662
std      91 days 00:47:33.924168
min              0 days 00:00:00
25%             10 days 00:00:00
50%             31 days 00:00:00
75%             89 days 00:00:00
max            533 days 00:00:00
Name: 购买日期, dtype: object
</code></pre>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 订单周期分布</span></span><br><span class="line"></span><br><span class="line">(order_diff / np.timedelta64(<span class="number">1</span>,<span class="string">&#x27;D&#x27;</span>)).hist(bins = <span class="number">20</span>,figsize = (<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_59_0.png" alt="" /></p>
<p><strong>图表解析</strong>：</p>
<ul>
<li>订单周期呈指数分布</li>
<li>用户的平均购买周期是68天，而且大多数用户的购买周期低于100天</li>
<li>从图像看属于典型的长尾图，说明绝大部分用户的消费间隔较短。可以考虑将时间召回点设为消费后立即赠送优惠券，且在消费后10天左右对客户进行回访，消费后30天后提醒优惠券即将到期，消费后60天短信推送进行尝试召回。</li>
</ul>
</br>
<h3 id="用户生命周期"><a class="markdownIt-Anchor" href="#用户生命周期"></a> <strong>用户生命周期</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user_life = data.groupby(<span class="string">&#x27;用户ID&#x27;</span>)[<span class="string">&#x27;购买日期&#x27;</span>].agg([<span class="string">&#x27;min&#x27;</span>,<span class="string">&#x27;max&#x27;</span>])</span><br><span class="line">user_life.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1997-01-01</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1997-01-12</td>
      <td>1997-01-12</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1997-01-02</td>
      <td>1998-05-28</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1997-01-01</td>
      <td>1997-12-12</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1997-01-01</td>
      <td>1998-01-03</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<h3 id="用户消费占比"><a class="markdownIt-Anchor" href="#用户消费占比"></a> <strong>用户消费占比</strong></h3>
<h4 id="仅消费一次用户占比"><a class="markdownIt-Anchor" href="#仅消费一次用户占比"></a> <strong>仅消费一次用户占比</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只消费过一次的用户占比</span></span><br><span class="line"></span><br><span class="line">user_once = (user_life[<span class="string">&#x27;min&#x27;</span>] == user_life[<span class="string">&#x27;max&#x27;</span>]).value_counts()</span><br><span class="line">labels = [<span class="string">&#x27;只消费一次用户&#x27;</span>,<span class="string">&#x27;多次消费用户&#x27;</span>]</span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">plt.pie(user_once,explode=(<span class="number">0</span>,<span class="number">0.15</span>),labels=labels,autopct=<span class="string">&#x27;%2.1f%%&#x27;</span>,startangle=<span class="number">90</span>,</span><br><span class="line">       colors=(<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>),radius=<span class="number">1.5</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_62_0.png" alt="" /></p>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 具体描述</span></span><br><span class="line"></span><br><span class="line">(user_life[<span class="string">&#x27;max&#x27;</span>] - user_life[<span class="string">&#x27;min&#x27;</span>]).describe()</span><br></pre></td></tr></table></figure>
<pre><code>count                       23570
mean     134 days 20:55:36.987696
std      180 days 13:46:43.039788
min               0 days 00:00:00
25%               0 days 00:00:00
50%               0 days 00:00:00
75%             294 days 00:00:00
max             544 days 00:00:00
dtype: object
</code></pre>
<p><strong>图表解析</strong>：</p>
<ul>
<li>仅消费一次的用户占比为51.1%，进行多次消费用户占比48.9%.</li>
<li>而通过描述可知，用户的平均生命周期为134天，但中位数为0，说明大部分用户第一次消费也是最后一次，所以平均生命周期并不具有准确性。</li>
<li>用户生命周期最大值为544天，几乎等同于数据源总天数，代表这部分用户属于忠实拥护者，也是核心用户。</li>
</ul>
</br>
<h4 id="消费多次用户周期分布"><a class="markdownIt-Anchor" href="#消费多次用户周期分布"></a> <strong>消费多次用户周期分布</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多次消费用户的生命周期分布</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>))</span><br><span class="line">plt.subplot(<span class="number">121</span>)</span><br><span class="line">((user_life[<span class="string">&#x27;max&#x27;</span>] - user_life[<span class="string">&#x27;min&#x27;</span>]) / np.timedelta64(<span class="number">1</span>,<span class="string">&#x27;D&#x27;</span>)).hist(bins = <span class="number">15</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;二次消费以上用户的生命周期直方图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;天数&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;用户数&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤生命周期为0的用户</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">122</span>)</span><br><span class="line">user_twice = ((user_life[<span class="string">&#x27;max&#x27;</span>] - user_life[<span class="string">&#x27;min&#x27;</span>]).reset_index()[<span class="number">0</span>] / np.timedelta64(<span class="number">1</span>,<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line">user_twice[user_twice &gt; <span class="number">0</span>].hist(bins = <span class="number">30</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;二次消费以上用户的生命周期直方图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;天数&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;用户数&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_64_0.png" alt="" /></p>
<p><strong>图表解析</strong>：通过对比可知，去除周期为0的用户后，图像呈双峰结构。</p>
<ul>
<li>右图为过滤后的生命周期分布图，但仍然存在生命周期趋于0天的用户，说明部分低质量用户，虽然消费过两次，但并不能持续消费。需要在消费后短时间内进行再次消费引导。</li>
<li>少部分用户集中在50~300天之间，忠诚度一般。</li>
<li>另一个高峰出现在400天之后，这部分用户属于高质量用户，忠诚度较高，而且后期用户数还在增加，需要维护这批用户的利益，长期保持回访、让利。</li>
</ul>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 消费两次以上的用户的平均生命周期</span></span><br><span class="line"></span><br><span class="line">user_twice[user_twice &gt; <span class="number">0</span>].mean()</span><br></pre></td></tr></table></figure>
<pre><code>276.0448072247308
</code></pre>
<p><strong>图表解析</strong>：消费两次以上的用户平均生命周期为276天，远高于总体平均生命周期。所以在用户首次消费后进行引导及召回可以很有效提高用户的生命周期。</p>
</br>
<h3 id="复购率-回购率分析"><a class="markdownIt-Anchor" href="#复购率-回购率分析"></a> <strong>复购率 &amp; 回购率分析</strong></h3>
<h4 id="复购率"><a class="markdownIt-Anchor" href="#复购率"></a> <strong>复购率</strong></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pivoted_counts.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复购率 -- 自然月内，购买多次的用户占比</span></span><br><span class="line"><span class="comment"># 消费两次及以上为1，消费一次为0，没有消费为空</span></span><br><span class="line"></span><br><span class="line">purchare_r = pivoted_counts.applymap(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x &gt; <span class="number">1</span> <span class="keyword">else</span> np.NaN <span class="keyword">if</span> x == <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">purchare_r.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复购率折线图</span></span><br><span class="line"></span><br><span class="line">(purchare_r.<span class="built_in">sum</span>() / purchare_r.count()).plot(figsize = (<span class="number">16</span>,<span class="number">8</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_70_0.png" alt="" /></p>
<p><strong>图表解析</strong>：复购率稳定在20%~22%，而前三个月复购率低，可能是有大量新用户所导致。</p>
</br>
<h4 id="回购率"><a class="markdownIt-Anchor" href="#回购率"></a> <strong>回购率</strong></h4>
<blockquote>
<p>回购率 – 曾经购买的用户在某一时期内的再次购买占比</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">purchare_back</span>(<span class="params">data</span>):</span><br><span class="line">    status = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">        <span class="comment"># 本月进行过消费</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> data[i] == <span class="number">1</span>: </span><br><span class="line">            <span class="comment"># 下个月是否进行了消费</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> data[i+<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># 消费为1 -- 回购了</span></span><br><span class="line">                </span><br><span class="line">                status.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> data[i+<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># 消费为0 -- 没有回购</span></span><br><span class="line">                </span><br><span class="line">                status.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 之前没消费则不进行计算</span></span><br><span class="line">            </span><br><span class="line">            status.append(np.NaN)</span><br><span class="line">    <span class="comment"># 主要对最后一个月进行判断处理</span></span><br><span class="line">    </span><br><span class="line">    status.append(np.NaN)</span><br><span class="line">    <span class="keyword">return</span> pd.Series(status,data_purchase.columns)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">purchare_b = data_purchase.apply(purchare_back,axis = <span class="number">1</span>)</span><br><span class="line">purchare_b.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1997-01-01</th>
      <th>1997-02-01</th>
      <th>1997-03-01</th>
      <th>1997-04-01</th>
      <th>1997-05-01</th>
      <th>1997-06-01</th>
      <th>1997-07-01</th>
      <th>1997-08-01</th>
      <th>1997-09-01</th>
      <th>1997-10-01</th>
      <th>1997-11-01</th>
      <th>1997-12-01</th>
      <th>1998-01-01</th>
      <th>1998-02-01</th>
      <th>1998-03-01</th>
      <th>1998-04-01</th>
      <th>1998-05-01</th>
      <th>1998-06-01</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 折线图</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize = (<span class="number">20</span>,<span class="number">8</span>))</span><br><span class="line">plt.subplot(<span class="number">211</span>)</span><br><span class="line">(purchare_b.<span class="built_in">sum</span>() / purchare_b.count()).plot()</span><br><span class="line">plt.title(<span class="string">&#x27;用户回购率分析&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;百分比%&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">212</span>)</span><br><span class="line">plt.plot(purchare_b.<span class="built_in">sum</span>(),label = <span class="string">&#x27;每月消费人数&#x27;</span>)</span><br><span class="line">plt.plot(purchare_b.count(),label = <span class="string">&#x27;每月回购人数&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;月份&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;用户数&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_75_0.png" alt="" /></p>
<p><strong>图表分析</strong>：</p>
<ul>
<li>回购率基本稳定在25%～35%，较高于复购率，但波动性较大。新用户回购率在15%左右，与老用户相差不大</li>
<li>从消费人数分布图可以发现，回购人数在前三个月后趋于稳定，所以波动的原因有可能是营销淡旺季所导致</li>
<li>结合回购率复购率，可以看出新用户的整体忠诚度低于老用户，而老用户回购率较高，消费频次较低。</li>
</ul>
</br>
<h3 id="留存率分析"><a class="markdownIt-Anchor" href="#留存率分析"></a> <strong>留存率分析</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user_purchare = data[[<span class="string">&#x27;用户ID&#x27;</span>,<span class="string">&#x27;订单数&#x27;</span>,<span class="string">&#x27;订单金额&#x27;</span>,<span class="string">&#x27;购买日期&#x27;</span>]]</span><br><span class="line">user_purchare.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>订单数</th>
      <th>订单金额</th>
      <th>购买日期</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>12.00</td>
      <td>1997-01-12</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>77.00</td>
      <td>1997-01-12</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-01-02</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-03-30</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">user_purchare_retention = pd.merge(left = user_purchare,</span><br><span class="line">                                  right = user_life[<span class="string">&#x27;min&#x27;</span>].reset_index(),</span><br><span class="line">                                  how = <span class="string">&#x27;inner&#x27;</span>,</span><br><span class="line">                                  on = <span class="string">&#x27;用户ID&#x27;</span>)</span><br><span class="line">user_purchare_retention[<span class="string">&#x27;order_dt_diff&#x27;</span>] = user_purchare_retention[<span class="string">&#x27;购买日期&#x27;</span>] - user_purchare_retention[<span class="string">&#x27;min&#x27;</span>]</span><br><span class="line">user_purchare_retention[<span class="string">&#x27;dt_diff&#x27;</span>] = user_purchare_retention.order_dt_diff.apply(<span class="keyword">lambda</span> x: x / np.timedelta64(<span class="number">1</span>,<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line">user_purchare_retention.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>订单数</th>
      <th>订单金额</th>
      <th>购买日期</th>
      <th>min</th>
      <th>order_dt_diff</th>
      <th>dt_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
      <td>1997-01-01</td>
      <td>0 days</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>12.00</td>
      <td>1997-01-12</td>
      <td>1997-01-12</td>
      <td>0 days</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>77.00</td>
      <td>1997-01-12</td>
      <td>1997-01-12</td>
      <td>0 days</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-01-02</td>
      <td>1997-01-02</td>
      <td>0 days</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-03-30</td>
      <td>1997-01-02</td>
      <td>87 days</td>
      <td>87.0</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 区间分组</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bin</span> = [<span class="number">0</span>,<span class="number">30</span>,<span class="number">60</span>,<span class="number">90</span>,<span class="number">120</span>,<span class="number">150</span>,<span class="number">180</span>,<span class="number">365</span>]</span><br><span class="line">user_purchare_retention[<span class="string">&#x27;date_diff_bin&#x27;</span>] = pd.cut(user_purchare_retention.dt_diff,bins = <span class="built_in">bin</span>)</span><br><span class="line">user_purchare_retention.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>用户ID</th>
      <th>订单数</th>
      <th>订单金额</th>
      <th>购买日期</th>
      <th>min</th>
      <th>order_dt_diff</th>
      <th>dt_diff</th>
      <th>date_diff_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>11.77</td>
      <td>1997-01-01</td>
      <td>1997-01-01</td>
      <td>0 days</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>12.00</td>
      <td>1997-01-12</td>
      <td>1997-01-12</td>
      <td>0 days</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2</td>
      <td>5</td>
      <td>77.00</td>
      <td>1997-01-12</td>
      <td>1997-01-12</td>
      <td>0 days</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-01-02</td>
      <td>1997-01-02</td>
      <td>0 days</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>20.76</td>
      <td>1997-03-30</td>
      <td>1997-01-02</td>
      <td>87 days</td>
      <td>87.0</td>
      <td>(60.0, 90.0]</td>
    </tr>
    <tr>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>19.54</td>
      <td>1997-04-02</td>
      <td>1997-01-02</td>
      <td>90 days</td>
      <td>90.0</td>
      <td>(60.0, 90.0]</td>
    </tr>
    <tr>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>57.45</td>
      <td>1997-11-15</td>
      <td>1997-01-02</td>
      <td>317 days</td>
      <td>317.0</td>
      <td>(180.0, 365.0]</td>
    </tr>
    <tr>
      <td>7</td>
      <td>3</td>
      <td>4</td>
      <td>20.96</td>
      <td>1997-11-25</td>
      <td>1997-01-02</td>
      <td>327 days</td>
      <td>327.0</td>
      <td>(180.0, 365.0]</td>
    </tr>
    <tr>
      <td>8</td>
      <td>3</td>
      <td>1</td>
      <td>16.99</td>
      <td>1998-05-28</td>
      <td>1997-01-02</td>
      <td>511 days</td>
      <td>511.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>29.33</td>
      <td>1997-01-01</td>
      <td>1997-01-01</td>
      <td>0 days</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pivoted_retention = user_purchare_retention.pivot_table(index=<span class="string">&#x27;用户ID&#x27;</span>,columns=<span class="string">&#x27;date_diff_bin&#x27;</span>,values=<span class="string">&#x27;订单金额&#x27;</span>,aggfunc=<span class="built_in">sum</span>)</span><br><span class="line">pivoted_retention.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date_diff_bin</th>
      <th>(0, 30]</th>
      <th>(30, 60]</th>
      <th>(60, 90]</th>
      <th>(90, 120]</th>
      <th>(120, 150]</th>
      <th>(150, 180]</th>
      <th>(180, 365]</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>78.41</td>
    </tr>
    <tr>
      <td>4</td>
      <td>29.73</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>41.44</td>
    </tr>
    <tr>
      <td>5</td>
      <td>13.97</td>
      <td>38.90</td>
      <td>NaN</td>
      <td>45.55</td>
      <td>38.71</td>
      <td>26.14</td>
      <td>155.54</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>97.43</td>
    </tr>
    <tr>
      <td>8</td>
      <td>NaN</td>
      <td>13.97</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>45.29</td>
      <td>104.17</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pivoted_retention.mean()</span><br></pre></td></tr></table></figure>
<pre><code>date_diff_bin
(0, 30]       51.540649
(30, 60]      50.215070
(60, 90]      48.975277
(90, 120]     48.649005
(120, 150]    51.399450
(150, 180]    49.932592
(180, 365]    91.960059
dtype: float64
</code></pre>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pivoted_retention_trans = pivoted_retention.fillna(<span class="number">0</span>).applymap(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x&gt;<span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">pivoted_retention_trans.head()</span><br></pre></td></tr></table></figure>
</br>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>date_diff_bin</th>
      <th>(0, 30]</th>
      <th>(30, 60]</th>
      <th>(60, 90]</th>
      <th>(90, 120]</th>
      <th>(120, 150]</th>
      <th>(150, 180]</th>
      <th>(180, 365]</th>
    </tr>
    <tr>
      <th>用户ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">((pivoted_retention_trans.<span class="built_in">sum</span>() / pivoted_retention_trans.count()) * <span class="number">100</span>).plot.bar(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line">plt.ylabel(<span class="string">&#x27;百分比%&#x27;</span>)</span><br><span class="line">plt.xticks(fontsize = <span class="number">16</span>,rotation = <span class="number">360</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;各时间区间的用户留存率&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://testingcf.jsdelivr.net/gh/minzvv/blogimg/cdnow/output_83_0.png" alt="" /></p>
<p><strong>图表解析</strong>：</p>
<ul>
<li>第一个月的留存率达到了38%，历经两个月下滑，之后趋于稳定。说明用户在通过前三个月的使用，逐渐出现分歧，即部分用户成为忠实用户，剩余部分用户流失。有20%左右的用户在第一次购买后的三个月到半年之间有过再次消费，27%的用户在半年后至一年内进行了再次购买。</li>
<li>相比于拉新而言，应该更注重用户忠诚度的培养。如果进行活动，应该放在前三个月。</li>
<li>结合用户生命周期，用户的平均消费时间间隔为68天，所以应该在60天左右的间隔对用户进行召回和引导。</li>
</ul>
</br>
<h2 id="写在最后"><a class="markdownIt-Anchor" href="#写在最后"></a> <strong>写在最后</strong></h2>
<p>以上为CDNow网站用户消费行为分析的全部内容，有错误之处，恳请指正。感谢阅读！</p>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/2021/05/10/%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%AE%A4%E7%9F%A5/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/%E6%95%B0%E6%8D%AE%E6%8C%87%E6%A0%87/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    到底什么是数据指标？
                
            </div>
        </a>
    
    
        <a href="/2021/04/16/%E6%8A%98%E8%85%BE%E8%AE%B0%E5%BD%95/you-get-%E4%B8%8B%E8%BD%BD%E8%A7%86%E9%A2%91/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">如何使用you-get获取视频？</div>
        </a>
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            Minz &copy; 2023 
            <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a target="_blank" rel="noopener" href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        

    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>